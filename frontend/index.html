<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ðŸ§  FullTask AI Tutor</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      margin: 0;
      background-color: #0d1117;
      color: #e6edf3;
      display: flex;
      min-height: 100vh;
    }
    /* Sidebar */
    aside {
      width: 260px;
      background: #161b22;
      padding: 20px;
      box-sizing: border-box;
      border-right: 1px solid #30363d;
    }
    aside h2 {
      margin-top: 0;
      color: #58a6ff;
    }
    #history {
      list-style: none;
      padding: 0;
      margin-top: 10px;
      max-height: 70vh;
      overflow-y: auto;
    }
    #history li {
      background: #21262d;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 8px;
      font-size: 0.9rem;
    }
    #history b {
      color: #79c0ff;
    }
    /* Main */
    main {
      flex: 1;
      padding: 30px;
      box-sizing: border-box;
    }
    h1 {
      font-size: 1.6rem;
      color: #58a6ff;
      margin-bottom: 8px;
    }
    .subjects {
      margin-bottom: 10px;
    }
    .subjects button {
      background: #21262d;
      color: #c9d1d9;
      border: 1px solid #30363d;
      border-radius: 8px;
      margin: 2px;
      padding: 8px 12px;
      cursor: pointer;
      transition: 0.2s;
    }
    .subjects button:hover {
      background: #238636;
      color: #fff;
    }
    textarea {
      width: 100%;
      height: 80px;
      border-radius: 8px;
      background: #161b22;
      color: #e6edf3;
      border: 1px solid #30363d;
      padding: 10px;
      resize: none;
      font-size: 1rem;
    }
    .controls {
      margin-top: 10px;
    }
    button.ask {
      background: #238636;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px 20px;
      cursor: pointer;
      font-size: 1rem;
    }
    button.read {
      background: #30363d;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px 20px;
      cursor: pointer;
      font-size: 1rem;
      margin-left: 10px;
    }
    #aiResponse {
      margin-top: 20px;
      background: #161b22;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #30363d;
      min-height: 60px;
    }
    footer {
      text-align: center;
      padding: 10px;
      border-top: 1px solid #30363d;
      color: #8b949e;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <aside>
    <h2>ðŸ“˜ Saved History</h2>
    <ul id="history"></ul>
  </aside>

  <main>
    <h1>ðŸ§  FullTask AI Tutor</h1>
    <p>Biology â€¢ Chemistry â€¢ Nursing â€¢ Physics â€¢ Math â€¢ English</p>
    <p><b>Profile:</b> Akin Saye Sokpah <button id="signOut">Sign out</button></p>

    <h2>ðŸ§  Ask anything about <span id="subjectLabel">Biology</span></h2>

    <div class="subjects">
      <button onclick="setSubject('Biology')">Biology</button>
      <button onclick="setSubject('Chemistry')">Chemistry</button>
      <button onclick="setSubject('Physics')">Physics</button>
      <button onclick="setSubject('Mathematics')">Mathematics</button>
      <button onclick="setSubject('Nursing')">Nursing</button>
      <button onclick="setSubject('English')">English</button>
    </div>

    <textarea id="userQuestion" placeholder="Ask your question..."></textarea>

    <div class="controls">
      <button class="ask" id="askBtn">Ask AI</button>
      <button class="read" id="readBtn">ðŸ”Š Read aloud</button>
    </div>

    <div id="aiResponse">Your AI Tutor is ready to help!</div>

    <footer>
      FullTask AI Tutor â€” created by <b>Akin S. Sokpah (Liberia)</b>.
    </footer>
  </main>

  <script>
    const API_URL = "https://ai-tutor-e5m3.onrender.com/api/ask"; // âœ… your backend
    const askBtn = document.getElementById("askBtn");
    const readBtn = document.getElementById("readBtn");
    const aiResponse = document.getElementById("aiResponse");
    const userQuestion = document.getElementById("userQuestion");
    const historyList = document.getElementById("history");
    let currentSubject = "Biology";

    function setSubject(subject) {
      currentSubject = subject;
      document.getElementById("subjectLabel").textContent = subject;
    }

    askBtn.addEventListener("click", async () => {
      const question = userQuestion.value.trim();
      if (!question) {
        aiResponse.textContent = "âš ï¸ Please enter a question.";
        return;
      }

      aiResponse.textContent = "â³ Thinking...";

      try {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ question, subject: currentSubject })
        });

        if (!res.ok) throw new Error("Bad server response");

        const data = await res.json();
        aiResponse.textContent = data.answer || "ðŸ¤” No answer received.";
        saveToHistory(question, data.answer);
      } catch (err) {
        console.error(err);
        aiResponse.textContent = "âš ï¸ Error connecting to AI Tutor. Please try again.";
      }
    });

    readBtn.addEventListener("click", () => {
      const msg = new SpeechSynthesisUtterance(aiResponse.textContent);
      msg.lang = "en-US";
      speechSynthesis.speak(msg);
    });

    function saveToHistory(q, a) {
      const item = document.createElement("li");
      item.innerHTML = `<b>Q:</b> ${q}<br><b>A:</b> ${a}`;
      historyList.prepend(item);
    }
  </script>
</body>
</html>
